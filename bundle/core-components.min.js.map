{"version":3,"file":"core-components.min.js","sources":["../packages/utils.js","../packages/core-datepicker/node_modules/polyfill-custom-event/index.js","../packages/core-datepicker/core-datepicker.js","../packages/core-toggle/core-toggle.js","../packages/core-dropdown/core-dropdown.js","../packages/core-input/core-input.js"],"sourcesContent":["/**\n* assign\n* @param {Object} target The target object\n* @param {Object} sources The source object(s)\n* @return {Object} The target object\n*/\nexport function assign (target, ...sources) {\n  sources.filter(Boolean).forEach((source) => {\n    Object.keys(source).forEach((key) => (target[key] = source[key]))\n  })\n  return target\n}\n\n/**\n* addEvent\n* @param {String} uuid An unique ID of the event to bind - ensurnes single instance\n* @param {String} type The type of event to bind\n* @param {Function} handler The function to call on event\n*/\nexport function addEvent (uuid, type, handler) {\n  if (typeof window === 'undefined' || window[`${uuid}-${type}`]) return      // Ensure single instance\n  document.addEventListener(type, handler, window[`${uuid}-${type}`] = true)  // Use capture for old Firefox\n}\n\n/**\n* attr\n* @param {Element} element HTMLElement to change attributes on\n* @param {String|Object} name A name of an attribute or object of attributes to set or remove\n* @param {Mixed} [value] An optional value to set (use null to remove). If not specified - retuns value\n* @return {Element|String} element\n*/\nexport function attr (element, name, value) {\n  if (arguments.length === 3) element[value === null ? 'removeAttribute' : 'setAttribute'](name, value)\n  else if (typeof name === 'string') return element.getAttribute(name)\n  else Object.keys(value).forEach((n) => attr(element, name, value[n]))\n  return element\n}\n\n/**\n* CustomEvent\n* See {@link https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent}\n* @param {String} eventName A case-sensitive string representing the event type to create\n* @param {Object} params.detail Any data passed when initializing the event\n* @param {Boolean} params.cancelable A Boolean indicating whether the event is cancelable.\n* @param {Boolean} params.bubbles A Boolean indicating whether the event bubbles up through the DOM or not.\n* @return {CustomEvent} Creates a CustomEvent.\n*/\nexport const CustomEvent = (() => {\n  if (typeof window === 'undefined') return\n  if (typeof window.CustomEvent === 'function') return window.CustomEvent\n\n  function CustomEvent (name, params = {}) {\n    const event = document.createEvent('CustomEvent')\n    event.initCustomEvent(name, Boolean(params.bubbles), Boolean(params.cancelable), params.detail)\n    return event\n  }\n\n  CustomEvent.prototype = window.Event.prototype\n  return CustomEvent\n})()\n\n/**\n* debounce\n* @param {Function} callback The function to debounce\n* @param {Number} ms The number of milliseconds to delay\n* @return {Function} The new debounced function\n*/\nexport function debounce (callback, ms) {\n  let timer\n  return function (...args) {\n    const self = this\n    clearTimeout(timer)\n    timer = setTimeout(() => callback.apply(self, args), ms)\n  }\n}\n\n/**\n* dispatchEvent\n* @param {Element} elem The target object\n* @param {String} name The source object(s)\n* @param {Object} detail Detail object (bubbles and cancelable defaults to true)\n* @return {Boolean} Whether the event was cance\n*/\nexport function dispatchEvent (elem, name, detail = {}) {\n  return elem.dispatchEvent(new CustomEvent(name, {detail, bubbles: true, cancelable: true}))\n}\n\n/**\n* escapeHTML\n* @param {String} str A string with potential html tokens\n* @return {String} Escaped HTML string according to OWASP recommendation\n*/\nconst ESCAPE_HTML_MAP = {'&': '&amp;', '<': '&lt;', '>': '&gt;', '\"': '&quot;', '/': '&#x2F;', '\\'': '&#x27;'}\nexport function escapeHTML (str) {\n  return String(str || '').replace(/[&<>\"'/]/g, (char) => ESCAPE_HTML_MAP[char])\n}\n\n/**\n* getUUID\n* @return {String} A generated unique ID\n*/\nexport function getUUID (el, attr) {\n  return Date.now().toString(36) + Math.random().toString(36).slice(2, 5)\n}\n\n/**\n* queryAll\n* @param {String|NodeList|Array|Element} elements A CSS selector string, nodeList, element array, or single element\n* @return {Array} Array of elements\n*/\nexport function queryAll (elements, context = document) {\n  if (typeof elements === 'string') return queryAll(context.querySelectorAll(elements))\n  if (elements.length) return [].slice.call(elements)\n  return elements.nodeType ? [elements] : []\n}\n\n/**\n* queryAll\n* @param {Element} [context] A element to find focusable elements within\n* @return {Array} Array of focusable elements\n*/\nexport function queryFocusable (context = document) {\n  return queryAll(`\n    a,\n    button,\n    input,\n    select,\n    textarea,\n    iframe,\n    [tabindex]\n    [contenteditable=\"true\"]\n  `, context).filter((el) => !el.disabled)\n}\n","let polyfilled = false;\n\nif(typeof window !==\"undefined\" && typeof window.CustomEvent !== \"function\") {\n\n\tfunction CustomEvent ( event, params = { bubbles: false, cancelable: false, detail: undefined } ) {\n    \tvar evt = document.createEvent( 'CustomEvent' );\n    \tevt.initCustomEvent( event, params.bubbles, params.cancelable, params.detail );\n    \treturn evt;\n\t}\n\n\tCustomEvent.prototype = window.Event.prototype;\n\n\twindow.CustomEvent = CustomEvent;\n\n\tpolyfilled = true;\n\n};\n\nexport default polyfilled;\n","// import {name, version} from './package.json'\nimport {queryAll, addEvent} from '../utils'\nimport 'polyfill-custom-event'\n\nconst KEY = 'core-datepicker' //`${name}-${version}`                    // Unique id of component\n\nexport default function datepicker (...args) {              // Expose component\n  return new Datepicker(...args)\n}\n\nclass Datepicker {\n  constructor (elements) {\n    this.elements = queryAll(elements, KEY)\n    // tabindex=\"0\" på datepicker kun lytte til events på disse\n  }\n  open (open = true) {}\n  close (open = false) {}\n}\n\n\n/* <table>\n  <caption></caption>\n  <thead></thead>\n  <tbody></tbody>\n  <tfoot></tfoot>\n</table> */\n","import {version} from './package.json'\nimport {addEvent, dispatchEvent, getUUID, queryAll} from '../utils'\n\ntoggle.UUID = `data-toggle-${version.replace(/\\D/g, '-')}`\n\n/**\n* toggle\n* @param {String|NodeList|Array|Element} elements A CSS selector string, nodeList, element array, or single element\n* @param {Boolean} [open] Optional. True will open, false will close, undefined just updates attribute\n* @return {Array} Array of elements\n*/\nexport default function toggle (elements, open = null) {\n  return queryAll(elements).map((master) => {\n    const prevOpen = master.getAttribute('aria-expanded') === 'true'\n    const wantOpen = open === null ? prevOpen : Boolean(open)\n    const nextOpen = (prevOpen !== wantOpen && dispatchEvent(master, 'toggle')) ? wantOpen : prevOpen\n    const slave = master.nextElementSibling\n\n    master.setAttribute(toggle.UUID, '')\n    master.setAttribute('aria-expanded', nextOpen)\n    master.setAttribute('aria-controls', slave.id = slave.id || getUUID())\n    slave.setAttribute('aria-labelledby', master.id = master.id || getUUID())\n    slave[nextOpen ? 'removeAttribute' : 'setAttribute']('hidden', '')\n\n    return master\n  })\n}\n\naddEvent(toggle.UUID, 'click', (event) => {\n  queryAll(`[${toggle.UUID}]`).forEach((el) => {\n    const open = el.getAttribute('aria-expanded') === 'true'\n    const pops = el.getAttribute('aria-haspopup') === 'true'\n\n    if (el.contains(event.target)) toggle(el, !open)\n    else if (pops && open && dispatchEvent(el, 'toggle.outside')) toggle(el, false)\n  })\n})\n","import toggle from '../core-toggle/core-toggle'\nimport {attr, addEvent, queryFocusable} from '../utils'\n\nconst KEYS = {ESC: 27, PAGEUP: 33, PAGEDOWN: 34, END: 35, HOME: 36, LEFT: 37, UP: 38, RIGHT: 39, DOWN: 40}\n\nexport default function dropdown (elements, open) {\n  return toggle(elements, open).map((el) => attr(el, 'aria-haspopup', 'true'))\n}\n\naddEvent(toggle.UUID, 'keydown', (event) => {\n  if (event.ctrlKey || event.altKey || event.metaKey) return                          // Let browser do it's thing\n  for (let el = event.target; el; el = el.parentElement) {                            // Bubble up the DOM tree\n    const master = document.getElementById(el.getAttribute('aria-labelledby')) || el  // getElementById is performat enough\n    const popup = master.hasAttribute(toggle.UUID) && master.getAttribute('aria-haspopup') === 'true'\n    if (popup) return onKey(event, master, master.nextElementSibling)\n  }\n})\n\nfunction onKey (event, master, slave) {\n  const focusable = queryFocusable(slave)\n  const index = focusable.indexOf(document.activeElement)\n  let focus\n\n  if (event.keyCode === KEYS.ESC) focus = master\n  else if (event.keyCode === KEYS.UP) focus = focusable[index - 1] || focusable.pop()\n  else if (event.keyCode === KEYS.DOWN) focus = focusable[index + 1] || focusable[0]\n  else if (event.keyCode === KEYS.HOME || event.keyCode === KEYS.PAGEUP) focus = focusable[0]\n  else if (event.keyCode === KEYS.END || event.keyCode === KEYS.END) focus = focusable.pop()\n  else focus = focusable.filter((el) => el.textContent.toLowerCase()[0] === event.key)[0]\n\n  if (focus) {\n    event.preventDefault()\n    toggle(master, focus !== master)\n    focus.focus()\n  }\n}\n","// import {name, version} from './package.json'\nimport toggle from '../core-toggle/core-toggle'\nimport {addEvent, getUUID, queryAll} from '../utils'\n\n// const KEY = 'core-input' //`${name}-${version}`  // Unique id of component\nconst SPEAKER = typeof document !== 'undefined' && document.createElement('span') // For screen reader text\n\n// const OPTIONS = {\n//   items: 10,\n//   onHits: () => {},\n//   sort: (itemA, itemB) => 0,\n//   item: (item, input) => (item.label || item.value).replace(input.regex, '<b>' + input.query + '</b>'),\n//   filter: (item, input) => item.value.indexOf(input.query) !== -1,\n//   value: (item) => ({value: item.value, label: 'Hei'}),\n//   getItems: () => {},\n//   list: (query) => {\n//     return ['gmail.com', 'hotmail.com'].map((provider) => {\n//       return `${query}@${provider}`\n//     })\n//   }\n// }\n\nexport default function input (elements, options) {\n  return toggle(elements).map((master) => {\n    const slave = maste.nextElementSibling\n    const mode = options.mode || el.getAttribute('aria-autocomplete') || 'list' // both = suggest, list = hits\n\n    master.setAttribute('role', 'combobox')\n    master.setAttribute('autocomplete', false)\n    master.setAttribute('aria-autocomplete', mode)\n    // master.setAttribute('aria-owns', )\n    // slave.setAttribute('role', 'listbox')\n\n  })\n}\n\naddEvent(toggle.UUID, 'toggle', ({target}) => {\n  const input = target.getAttribute('role') === 'combobox'\n  // const live = ARIA_LIVE_EL\n  // slave.style.width = `${el.offsetWidth}px`\n  // live.setAttribute('aria-hidden', true|false)\n})\n\naddEvent(toggle.UUID, 'input', (event) => {\n\n})\n\nfunction evaluate (el) {\n  const value = el.value.trim().toLowerCase()\n  const index = 0\n  const list = el.nextElementSibling\n  // const hits = [].map.call(list.children, (el) => el.textContent).filter((item) => item.toLowerCase().indexOf(value) !== -1)\n  // console.log(value, list, hits)\n\n  ARIA_LIVE_EL.setAttribute('aria-hidden', false)\n  ARIA_LIVE_EL.textContent = `${hits.length} treff`\n\n  el.setAttribute('aria-expanded', true) // should be false if no hits?\n  // el.setAttribute('aria-activedescendant')\n  list.removeAttribute('hidden')\n  list.style.width = `${el.offsetWidth}px`\n  list.innerHTML = hits.map(({value}, i) => `<li role=\"option\" aria-selected=\"${i === index}\">${value}</li>`).join('')\n}\n\nfunction onKey (el, event) {\n  // evaluate(el)\n  if (mode === 'list') ARIA_LIVE_EL.textContent = to.textContent || 'Tomt tekstfelt'\n  else el.value = to.textContent\n}\n\nif (SPEAKER) {\n  SPEAKER.style.fontSize = '0px' // Hide visually\n  SPEAKER.setAttribute('aria-hidden', true)\n  SPEAKER.setAttribute('aria-live', 'assertive')\n  document.documentElement.appendChild(SPEAKER)\n}\n\n// var regex = new RegExp(input.query.replace(/[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g, '\\\\$&'), 'gi')\n/*const input = components.input(element, false)\ninput.evaluate()\ninput.focus()*/\n\n// (function(){\n//   var map = {'&': '&amp;', '<': '&lt;', '>': '&gt;', '\"': '&quot;', '/': '&#x2F;', '\\'': '&#x27;'};\n//   var esc = function(str){return String(str||'').replace(/[&<>\"'/]/g, function(v){return map[v]})};\n//   var ajax = new XMLHttpRequest();\n//   var input = document.search.elements.s;\n//   var output = input.nextElementSibling;\n//\n//   var search = function(){\n//     ajax.open('GET', action + encodeURIComponent(input.value));\n//     ajax.send();\n//   }\n//   var action = input.getAttribute('data-action');\n//   var timer;\n//\n//   ajax.onload = function(){               //Render hits\n//     output.hidden = false;\n//     output.innerHTML = ajax.responseText;\n//   };\n//\n//   document.addEventListener('keydown', function(event){  //Keyboard navigation\n//     if(!document.search.contains(event.target) || !input.value)return;\n//     if(event.keyCode === 27)return input.value = output.innerHTML = '';\n//     if(event.keyCode === 38 || event.keyCode === 40){\n//       var items = output.getElementsByTagName('a');\n//       var index = [].indexOf.call(items, document.activeElement);\n//       var focus = items[(index + (event.keyCode === 38? -1 : 1)) % items.length] || input;\n//       event.preventDefault();\n//       focus.focus();\n//     }\n//   });\n//\n//   input.addEventListener('focus', function(event){output.hidden = false});\n//   input.addEventListener('input', function(event){   //Debounced search on type\n//     clearTimeout(timer);\n//     ajax.abort();\n//     if(!input.value)output.innerHTML = '';\n//     else{\n//       timer = setTimeout(search, 500);\n//       output.innerHTML = '<li><span class=\"st-item\">Søker etter <strong>' + esc(input.value) + '</strong>...</span></li>';\n//     }\n//   });\n// })();\n"],"names":["addEvent","uuid","type","handler","window","document","addEventListener","CustomEvent","prototype","Event","name","params","const","event","createEvent","initCustomEvent","Boolean","bubbles","cancelable","detail","dispatchEvent","elem","getUUID","el","attr","Date","now","toString","Math","random","slice","queryAll","elements","context","querySelectorAll","length","call","nodeType","undefined","evt","Datepicker","this","open","close","toggle","map","master","prevOpen","getAttribute","wantOpen","nextOpen","slave","nextElementSibling","setAttribute","UUID","id","replace","forEach","pops","contains","target","KEYS","ESC","PAGEUP","PAGEDOWN","END","HOME","LEFT","UP","RIGHT","DOWN","onKey","focus","focusable","filter","disabled","index","indexOf","activeElement","keyCode","pop","textContent","toLowerCase","key","preventDefault","ctrlKey","altKey","metaKey","let","parentElement","getElementById","hasAttribute","SPEAKER","createElement","ref","style","fontSize","documentElement","appendChild","args","element","value","arguments","Object","keys","n","options","maste","mode"],"mappings":"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"}