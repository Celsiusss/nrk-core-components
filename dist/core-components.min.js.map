{"version":3,"file":"core-components.min.js","sources":["../src/utils.js","../src/details.js","../src/input.js","../src/core-components.js","../src/details.jsx","../src/input.jsx"],"sourcesContent":["const KEY = `core-components-${Date.now()}`\nconst STATES = {}\nlet UUID = 0\n\nexport function dispatchEvent (element, eventName, options) {\n  console.warn('TODO: polyfill customEvent')\n}\n\nexport function assign (target, ...sources) {\n  sources.filter(Boolean).forEach((source) => {\n    Object.keys(source).forEach((key) => (target[key] = source[key]))\n  })\n  return target\n}\n\nexport function attr (elements, attributes) {\n  getElements(elements).forEach((element) => {\n    Object.keys(attributes).forEach((name) => {\n      element[`${attributes[name] === null ? 'remove' : 'set'}Attribute`](name, attributes[name])\n    })\n  })\n  return elements\n}\n\nexport const closest = (element, nodeName) => {\n  for (var el = element; el; el = el.parentElement) {\n    if (el.nodeName.toLowerCase() === nodeName) return el\n  }\n}\n\nexport function getElements (elements) {\n  if (typeof elements === 'string') return getElements(document.querySelectorAll(elements))\n  if (elements && elements.length) return [].slice.call(elements)\n  if (elements && elements.nodeType) return [elements]\n  return []\n}\n\nexport function weakState (element, object, initial = {}) {\n  const uuid = element[KEY] || (element[KEY] = ++UUID)\n  const state = STATES[uuid] || (STATES[uuid] = initial)\n\n  if (object === false) {\n    delete element[KEY]\n    delete STATES[uuid]\n  } else if (typeof object === 'object') {\n    Object.keys(state).forEach((key) => (state[key] = object[key]))\n  }\n\n  return state\n}\n","import {attr, closest, dispatchEvent, getElements} from './utils'\n\nconst KEY = 'details-@VERSION'\nconst DETAILS = 'detail'\nconst SUMMARY = 'summar'\nconst ENTER_KEY = 13\nconst SPACE_KEY = 32\n\nexport function details (elements) {\n  if(!(this instanceof details)) return new details(elements) //eslint-disable-line\n  this.elements = getElements(elements)\n  this.elements.forEach((details) => toggle(details, details.hasAttribute('open')))\n}\n\ndetails.prototype.open = function (fn = true) {\n  this.elements.forEach((el, i) => toggle(el, fn, i))\n  return this\n}\ndetails.prototype.close = function (fn = true) {\n  this.elements.forEach((el, i) => toggle(el, !fn, i))\n  return this\n}\n\nfunction toggle (details, fn, index) {\n  const isOpen = Boolean(typeof fn === 'function' ? fn(details, index) : fn)\n  const slient = details.open === isOpen || 'ontoggle' in details\n\n  details[KEY] = true                           // Register polyfill\n  attr(details.querySelectorAll(SUMMARY), {\n    tabindex: 0,\n    role: 'button',\n    'aria-expanded': isOpen\n  })\n\n  // console.log(details.open, isOpen, details.hasAttribute('open'))\n  if (isOpen !== details.open) details.open = isOpen\n  if (isOpen !== details.hasAttribute('open')) attr(details, {open: isOpen || null})\n\n  slient || dispatchEvent(details, 'toggle')\n}\n\nfunction onKey (event) {\n  if (event.keyCode === ENTER_KEY || event.keyCode === SPACE_KEY) onClick(event)\n}\n\nfunction onClick (event) {\n  const summary = closest(event.target, SUMMARY)\n  const details = closest(event.target, DETAILS)\n\n  if (summary && details && KEY in details) {               // Only handle polyfilled elements\n    if (event.keyCode === SPACE_KEY) event.preventDefault() // Prevent scroll\n    toggle(details, !details.open)\n  }\n}\n\n// Make sure we are in a browser and have not already loaded the component\nif (typeof document !== 'undefined' && !document.getElementById(KEY)) {\n  document.createElement(DETAILS)                           // Shim <details> for IE and\n  document.createElement(SUMMARY)                           // Shim <summary> for IE\n  document.addEventListener('click', onClick)               // Polyfill click to toggle\n  document.addEventListener('keydown', onKey)               // Make <summary role=\"button\"> behave like <button>\n  document.head.insertAdjacentHTML('afterbegin',            // Insert css in top for easy overwriting\n    `<style id=\"${KEY}\">\n      ${SUMMARY}{display:block;cursor:pointer;touch-action:manipulation}\n      ${SUMMARY}::-webkit-details-marker{display:none}\n      ${SUMMARY}::before{content:'';padding-right:1em;background:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 10 10'%3E%3Cpath d='M0 0h10L5 10'/%3E%3C/svg%3E\") 0 45%/50% no-repeat}\n      ${SUMMARY}[aria-expanded=\"false\"]::before{background-image:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 10 10'%3E%3Cpath d='M0 0l10 5-10 5'/%3E%3C/svg%3E\")}\n      ${SUMMARY}[aria-expanded=\"false\"]~*{display:none}\n    </style>`)\n}\n","import {attr} from './utils'\n\nconst KEY = 'input-@VERSION'\nlet LIST // Element to contain list\nlet LIVE // Element to contain screen reader text\n\nfunction render (elem) {\n  const state = elem[KEY]\n  const value = state.value.trim().toLowerCase()\n  state.hits = state.items.filter((item) => item.value.toLowerCase().indexOf(value) !== -1)\n\n  attr(LIVE, {'aria-hidden': false})\n  attr(LIST, {'hidden': state.hits.length ? null : true})\n  attr(elem, {'aria-expanded': Boolean(state.hits.length)})\n\n  LIST.style.width = `${elem.offsetWidth}px`\n  LIST.innerHTML = state.hits.map(({value}, i) =>\n    `<li role=\"option\" aria-selected=\"${i === state.index}\">${value}</li>`\n  ).join('')\n}\n\nfunction onFocus (event) {\n  const elem = event.target\n  const controls = elem.getAttribute(`data-${KEY}`)\n\n  if (controls && !elem[KEY]) {\n    const mode = elem.getAttribute(`data-${KEY}-mode`) || 'suggestions'\n    const items = [].map.call(document.querySelectorAll(`#${controls} > *`), ({value}) => ({value}))\n    const parent = elem.parentElement\n\n    attr(elem, {\n      'role': 'combobox',\n      'autocomplete': 'off',\n      'aria-controls': `${KEY}-${controls}`,\n      'aria-autocomplete': 'list',\n      'aria-haspopup': true,\n      'aria-expanded': false\n    })\n\n    parent.className = parent.className.split(' ').concat(KEY).join(' ')\n    elem[KEY] = {items, mode, list: elem.nextElementSibling} // TODO: list\n  }\n\n  if (controls) {\n    LIST.id = `${KEY}-${controls}`\n    elem.insertAdjacentElement('afterend', LIST)\n    onInput(event)\n  }\n}\n\nfunction onBlur ({target}) {\n  if (target[KEY]) {\n    attr(LIST, 'hidden', 'hidden')\n    attr(LIVE, {'aria-hidden': 'true', 'aria-live': 'polite'})\n  }\n}\n\nfunction onInput (event) {\n  const elem = event.target\n  const state = elem[KEY]\n\n  if (state) {\n    state.index = -1\n    state.value = elem.value\n    render(elem)\n    LIVE.textContent = `${state.hits.length} treff`\n  }\n}\n\nfunction onKey (event) {\n  if (event.target[KEY]) {\n    const elem = event.target\n    const state = elem[KEY]\n    if (event.keyCode === 27) onBlur(event)\n    if (event.keyCode === 38 || event.keyCode === 40) {\n      event.preventDefault()\n      const hits = [].slice.call(LIST.children)\n      const selected = hits.filter((el) => el.getAttribute('aria-selected') === 'true')[0]\n      state.index = (hits.indexOf(selected) + (event.keyCode === 38 ? -1 : 1)) % hits.length\n      LIVE.setAttribute('aria-live', 'assertive')\n\n      render(event.target)\n      const value = (state.hits[state.index] || state).value\n      if (state.mode === 'results') {\n        LIVE.textContent = value || 'Tomt tekstfelt'\n      } else {\n        elem.value = value\n      }\n    }\n  }\n}\n\nif (typeof document !== 'undefined') {\n  attr(LIST = document.createElement('ul'), {role: 'listbox'})\n  attr(LIVE = document.createElement('span'), {'aria-hidden': 'true', 'aria-live': 'polite'})\n\n  // document.addEventListener('keydown', onKey)\n  // document.addEventListener('input', onInput)\n  // document.addEventListener('focus', onFocus, true) // Use capture to ensure event bubling\n  // document.addEventListener('blur', onBlur, true)   // Use capture to ensure event bubling\n  // document.documentElement.appendChild(LIVE)\n}\n\nexport function input () {\n  console.log('input')\n}\n","export const version = '@VERSION'\nexport {details} from './details'\nexport {Details} from './details.jsx'\nexport {input} from './input'\nexport {Input} from './input.jsx'\n","import {assign} from './utils'\nimport './details'              // Load polyfill\n\nexport function Details (props) {\n  const isOpen = props.open !== 'false' && Boolean(props.open)\n  const aria = {role: 'button', tabIndex: 0, 'aria-expanded': String(isOpen)}\n  let children = props.children\n\n  // Loop though children and augment <summary> with aria attributes\n  if (Array.isArray(children)) {\n    children = children.map((child, key) => {\n      const attr = assign({ref: child.ref, key}, child.props, child.type === 'summary' ? aria : {})\n      return child.type ? <child.type {...attr} /> : <div key={key}>{child}</div>\n    })\n  }\n\n  return <details {...props} open={isOpen}>{children}</details>\n}\n","export function Input () {\n  return <div>Testing input</div>\n}\n"],"names":["assign","target","sources","filter","Boolean","forEach","source","Object","keys","key","attr","elements","attributes","getElements","element","name","document","querySelectorAll","length","slice","call","nodeType","details","this","toggle","hasAttribute","fn","index","const","isOpen","slient","open","KEY","SUMMARY","tabindex","role","aria-expanded","console","warn","onClick","event","summary","closest","DETAILS","keyCode","SPACE_KEY","preventDefault","nodeName","el","parentElement","toLowerCase","ENTER_KEY","prototype","i","close","getElementById","createElement","addEventListener","head","insertAdjacentHTML","aria-hidden","aria-live","props","aria","tabIndex","String","children","Array","isArray","map","child","ref","type","React","log"],"mappings":"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"}